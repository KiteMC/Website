# 后端 API

## 用户注册与验证

### 发送邮箱验证码
- **接口**：`POST /api/send-code`
- **用途**：向指定邮箱发送注册验证码，防止恶意注册。
- **权限**：所有用户（无需登录）
- **请求头**：`Content-Type: application/json`
- **请求参数**：
  | 字段      | 类型   | 必填 | 说明           | 示例                |
  |-----------|--------|------|----------------|---------------------|
  | email     | string | 是   | 用户邮箱       | user@example.com    |
  | language  | string | 否   | 语言（zh/en）  | zh                  |
- **请求体示例**：
  ```json
  { "email": "user@example.com", "language": "zh" }
  ```
- **返回值**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | success | boolean | 是否成功     |
  | msg     | string  | 提示信息     |
- **成功示例**：
  ```json
  { "success": true, "msg": "验证码已发送" }
  ```
- **失败示例**：
  ```json
  { "success": false, "msg": "邮箱格式不正确或已被注册" }
  ```
- **注意事项**：
  - 邮箱每日/每分钟发送次数有限制，防止滥用。
  - 邮箱格式需符合 RFC 标准。

### 注册
- **接口**：`POST /api/register`
- **用途**：用户提交邮箱验证码和信息进行注册。
- **权限**：所有用户
- **请求头**：`Content-Type: application/json`
- **请求参数**：
  | 字段      | 类型   | 必填 | 说明           |
  |-----------|--------|------|----------------|
  | email     | string | 是   | 用户邮箱       |
  | code      | string | 是   | 邮箱验证码     |
  | uuid      | string | 是   | 玩家 UUID      |
  | username  | string | 是   | 玩家名         |
  | language  | string | 否   | 语言           |
- **请求体示例**：
  ```json
  { "email": "user@example.com", "code": "123456", "uuid": "玩家UUID", "username": "玩家名", "language": "zh" }
  ```
- **返回值**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | success | boolean | 是否成功     |
  | msg     | string  | 提示信息     |
- **成功示例**：
  ```json
  { "success": true, "msg": "注册成功" }
  ```
- **失败示例**：
  ```json
  { "success": false, "msg": "验证码错误或已过期" }
  ```
- **注意事项**：
  - 验证码有效期一般为 5 分钟。
  - 用户名、邮箱唯一。
  - 注册后可能需要管理员审核。

## 管理员与审核

### 管理员登录
- **接口**：`POST /api/admin-login`
- **用途**：管理员登录后台。
- **权限**：所有用户
- **请求头**：`Content-Type: application/json`
- **请求参数**：
  | 字段      | 类型   | 必填 | 说明           |
  |-----------|--------|------|----------------|
  | password  | string | 是   | 后台管理密码   |
  | language  | string | 否   | 语言           |
- **请求体示例**：
  ```json
  { "password": "your_admin_password", "language": "zh" }
  ```
- **返回值**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | success | boolean | 是否成功     |
  | token   | string  | JWT 认证令牌 |
  | message | string  | 提示信息     |
- **成功示例**：
  ```json
  { "success": true, "token": "JWT_TOKEN", "message": "登录成功" }
  ```
- **失败示例**：
  ```json
  { "success": false, "message": "密码错误" }
  ```
- **注意事项**：
  - 后续所有需要管理员权限的接口，需在请求头加 `Authorization: Bearer <token>`。

### 获取待审核用户列表
- **接口**：`GET /api/pending-list?language=zh`
- **用途**：获取所有待审核用户信息。
- **权限**：需管理员登录（需带 token）
- **请求头**：`Authorization: Bearer <token>`
- **请求参数**：
  | 字段      | 类型   | 必填 | 说明           |
  |-----------|--------|------|----------------|
  | language  | string | 否   | 语言           |
- **返回值**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | success | boolean | 是否成功     |
  | users   | array   | 用户数组     |
- **用户对象结构**：
  | 字段      | 类型   | 说明           |
  |-----------|--------|----------------|
  | uuid      | string | 玩家 UUID      |
  | username  | string | 玩家名         |
  | email     | string | 邮箱           |
  | status    | string | 状态（pending）|
  | regTime   | string | 注册时间       |
- **成功示例**：
  ```json
  {
    "success": true,
    "users": [
      { "uuid": "...", "username": "...", "email": "...", "status": "pending", "regTime": "..." }
    ]
  }
  ```
- **失败示例**：
  ```json
  { "success": false, "msg": "无权限" }
  ```

### 审核用户
- **接口**：`POST /api/review`
- **用途**：管理员审核用户（通过/拒绝）。
- **权限**：需管理员登录
- **请求头**：`Authorization: Bearer <token>`, `Content-Type: application/json`
- **请求参数**：
  | 字段      | 类型   | 必填 | 说明           |
  |-----------|--------|------|----------------|
  | uuid      | string | 是   | 玩家 UUID      |
  | action    | string | 是   | 操作类型（approve/reject）|
  | reason    | string | 否   | 拒绝原因       |
  | language  | string | 否   | 语言           |
- **请求体示例**：
  ```json
  { "uuid": "...", "action": "approve", "reason": "", "language": "zh" }
  ```
- **返回值**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | success | boolean | 是否成功     |
  | msg     | string  | 提示信息     |
- **成功示例**：
  ```json
  { "success": true, "msg": "操作成功" }
  ```
- **失败示例**：
  ```json
  { "success": false, "msg": "无权限或用户不存在" }
  ```

## 其他接口

### 获取配置
- **接口**：`GET /api/config`
- **用途**：获取前端、登录、公告等配置信息。
- **权限**：所有用户
- **返回值**：
  | 字段      | 类型   | 说明           |
  |-----------|--------|----------------|
  | login     | object | 登录相关配置   |
  | admin     | object | 管理员相关配置 |
  | frontend  | object | 前端相关配置   |
- **成功示例**：
  ```json
  {
    "login": { "enable_email": true, "email_smtp": "smtp.qq.com" },
    "admin": { ... },
    "frontend": { "theme": "glassx", "logo_url": "/logo.png", ... }
  }
  ```

### 获取用户状态
- **接口**：`GET /api/user-status?uuid=...`
- **用途**：查询指定用户的审核状态。
- **权限**：所有用户
- **请求参数**：
  | 字段      | 类型   | 必填 | 说明           |
  |-----------|--------|------|----------------|
  | uuid      | string | 是   | 玩家 UUID      |
- **返回值**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | success | boolean | 是否成功     |
  | data    | object  | 用户状态数据 |
- **data 对象结构**：
  | 字段    | 类型    | 说明         |
  |---------|---------|--------------|
  | status  | string  | 用户状态（如 approved/pending/rejected/banned）|
  | reason  | string  | 被拒绝或封禁原因（如有）|
- **成功示例**：
  ```json
  { "success": true, "data": { "status": "approved", "reason": "" } }
  ```

---

> 更多接口和参数详见源码或前端 `src/services/api.ts`。 